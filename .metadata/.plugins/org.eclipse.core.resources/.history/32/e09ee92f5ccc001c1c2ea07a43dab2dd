package com.chainsys.jdbc;

import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

public class Preparedstatement {
	 public static void main(String[] args) throws Exception
	    {
		 view();
	    
  	    }
	 public static void insert() throws Exception
	    {
	        Connection con=DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe","system","oracle");
	        PreparedStatement stmt=con.prepareStatement("insert into TABLE1 values(?,?,?,?,?)");
	        //insert details in console
	        BufferedReader br=new BufferedReader(new InputStreamReader(System.in));     
	        do
	        {
	        System.out.println("enter id:");  
	        int id=Integer.parseInt(br.readLine());  
	        System.out.println("enter name:");  
	        String name=br.readLine();  
	        System.out.println("enter age:");  
	        int age=Integer.parseInt(br.readLine());
	        System.out.println("enter dept:");  
	        String dept=br.readLine();
	        System.out.println("enter marks:");  
	        int marks=Integer.parseInt(br.readLine());
	        //values sets in table
	        stmt.setInt(1, id);
	        stmt.setString(2, name);
	        stmt.setInt(3,age);
	        stmt.setString(4,dept);
	        stmt.setInt(5,marks);
	        
	        //checking whether the table is inserted or not
	        int i=stmt.executeUpdate();
	        System.out.println(i+ " row inserted");    
	        
	        System.out.println("Do you want to continue: y/n");  
	        String s=br.readLine();  
	        if(s.startsWith("n"))
	        {  
	            break;  
	        }  
	        }while(true); 
	        con.close();
	    }
	    public static void update() throws Exception
	    {
	        Connection con=DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe","system","oracle");
	        PreparedStatement stmt=con.prepareStatement("update College set name=? where id=?");  
	        stmt.setString(1,"Ask");
	        stmt.setInt(2,100);  
	          
	        int i=stmt.executeUpdate();  
	        System.out.println(i+" records updated");  
	    }
	    public static void view() throws Exception
	    {
	        Connection con=DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe","system","oracle");
	        PreparedStatement stmt=con.prepareStatement("select * from College");  
	        ResultSet rs=stmt.executeQuery();  
	        while(rs.next())
	        {  
	            System.out.println(rs.getInt(1)+" "+rs.getString(2)+" "+rs.getString(3)+" "+rs.getInt(4));  
	        }  
	    }
	    public static void delete() throws Exception
	    {
	        Connection con=DriverManager.getConnection("jdbc:oracle:thin:@localhost:1521:xe","system","oracle");
	        PreparedStatement stmt=con.prepareStatement("delete from College where id=?");  
	        stmt.setInt(1,101);  
	          
	        int i=stmt.executeUpdate();  
	        System.out.println(i+" records deleted");  
	    }
	 
	 
}